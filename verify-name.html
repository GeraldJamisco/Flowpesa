<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Flowpesa â€” Name as in ID</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>

<main class="name-id-screen">
  <!-- Top bar -->
  <header class="top-bar">
    <div class="top">
      <button class="back-btn" type="button" onclick="history.back()" aria-label="Go back">
        <span class="back-dot"></span>
        <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M15 18L9 12l6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
      <h1 class="top-title"> </h1>
      <span class="top-ghost" aria-hidden="true"></span>
    </div>
  </header>

  <!-- Content -->
  <section class="content">
    <div class="title-row">
      <h2 class="heading">Name as in ID</h2>
      <span class="badge" aria-hidden="true">
        <svg width="22" height="22" viewBox="0 0 24 24">
          <rect x="3" y="3" width="18" height="18" rx="4" fill="#2A69FF" opacity=".22"/>
          <circle cx="12" cy="10" r="3" fill="#9CC2FF"/>
          <rect x="8" y="14" width="8" height="4" rx="2" fill="#9CC2FF"/>
        </svg>
      </span>
    </div>
    <p class="subheading">Name as in your official documents</p>

    <form id="name-form" novalidate>
      <!-- First name -->
      <label class="field">
        <span class="label">First Name</span>
        <input id="firstName" name="firstName" type="text" inputmode="text" autocomplete="given-name" maxlength="50" placeholder="First Name" />
        <div class="field-foot">
          <small class="hint">e.g, Rufat, not "Ruff"</small>
          <small class="count"><span id="firstCount">0</span>/50</small>
        </div>
      </label>

      <!-- Last name -->
      <label class="field">
        <span class="label">Last name</span>
        <input id="lastName" name="lastName" type="text" inputmode="text" autocomplete="family-name" maxlength="50" placeholder="Last name" />
      </label>

      <!-- Middle name (optional) -->
      <label class="field">
        <span class="label">Middle name</span>
        <input id="middleName" name="middleName" type="text" inputmode="text" maxlength="50" placeholder="Middle name" />
        <small class="optional">Optional</small>
      </label>

      <!-- CTA -->
      <button id="continueBtn" class="cta" type="submit" disabled>
        Continue
      </button>
    </form>
  </section>
</main>

<script>
  (function(){
    const first = document.getElementById('firstName');
    const last  = document.getElementById('lastName');
    const middle= document.getElementById('middleName');
    const btn   = document.getElementById('continueBtn');
    const cnt   = document.getElementById('firstCount');
    const form  = document.getElementById('name-form');

    const clean = s => s.replace(/\s+/g,' ').trim();

    function validate(){
      cnt.textContent = first.value.length;
      const ok = clean(first.value).length > 0 && clean(last.value).length > 0;
      btn.disabled = !ok;
      btn.classList.toggle('is-active', ok);
    }

    [first,last,middle].forEach(el => el.addEventListener('input', validate));
    window.addEventListener('DOMContentLoaded', validate);

    form.addEventListener('submit', e => {
      e.preventDefault(); validate();
      if (btn.disabled) return;
      const payload = {
        first_name: clean(first.value),
        last_name: clean(last.value),
        middle_name: clean(middle.value)
      };
      // TODO: POST to API then route to next step
      // fetch('/api/kyc/name', {...})
      location.href = 'verify-dob.html'; // next page
    });
  })();
</script>

</body>
</html>
